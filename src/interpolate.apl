rng ← {(⍳⍵)~(⍳⍺-1)}
prd ← {0=⍺|¯1+⍳⍵+1}
xs ← {s e←(1 1⊃⍵)(1 1⊃⌽⍵) ⋄ (⍺ prd e-s)/(s rng e)}
spans ← {x←⍺ xs ⍵ ⋄ ¯1↓x⊂⍨(⍳≢x)∊x⍸1⊃¨⍵}
ys ← {∊(2 2⊃⌽⍵),⍨(¯1↓∊1↓⍉↑⍵)+(÷/⌽2-⌿↑⍵)×{⍵-⊃⍵}¨⍺ spans ⍵}
interp ← (⍪xs),(⍪ys)
