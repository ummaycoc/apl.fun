p ← {⍵/⍨{≠/2|⍵}¨⍵}
r ← {⍵/⍨1=(∨/)¨⍵}
o ← {⍵/⍨>/¨⍵}
⍳ ← {,(⊢∘.,⊣)⍳⍵}
t ← {≤/⍵:0 ⋄ s←⍵*2 ⋄ {⍵[⍋⍵]}(-/s),(×/2,⍵),(+/s)}
s ← {⍵/⍨⍺≥+/¨⍵}
m ← {⊃,/⍺{(⍵∘×)¨⍳⌊⍺÷+/⍵}¨⍵}
g ← {⍺ m ⍺ s t¨r p o i ⍵}
f ← {⍵⌿⍨⍵[;2]=⌈/⍵[;2]}
f{⍺,≢⍵}⌸+/¨1000 g 21
